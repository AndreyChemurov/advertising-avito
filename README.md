# Сервис для хранения и подачи объявлений: Авито Advertising.

## Перед проверкой
- После отправки задания заметил грубую (как мне кажется, грубую) ошибку в пагинации. В случае удаления записей из таблицы (что не предусмотрено, но возможно в принципе), пагинация, завязанная на ID объявлений, не выводит их по 10 штук. Были добавлены операторы OFFSET и LIMIT для постоянного вывода 10ти объявлений в запросе.
- Если исправлять задание после отправки не разрешается, то прошу вернуться к истории репозитория от коммита d38fdef2ddb8d205912c0f06691ee5cc0f6c46fb (06.02.21)

## Информация
- Приложение работает на порту ```8000```
- Все запросы выполняются через POST методы с JSON телом.
- На транспортном уровне выполняется проверка валидности переданных в теле метода аргументов. Хендлеры формируют JSON-ответ на основе строго-типизировнных данных.
- На бизнес уровне создаются запросы и коннекшены с базой данных.
- Использовалось при создании: golang 1.15, postgres 13, linux debian 10.</br></br>

## Запуск приложения
```bash
git clone https://github.com/AndreyChemurov/advertising-avito.git
cd advertising-avito/
[sudo] docker-compose up
```

## Архитектура
1. Приложение состоит из 4 модулей: http, database, types, errors.
2. В http-модуле находятся хэндлеры. В них происходит проверка валидности переданных аргументов: проверка http-метода, корректности JSON'a и самих параметров. После проверки вызывается соответствующая функция бизнес-логики.
3. В database-модуле находится 2 файла: creation.go и usage.go. creation отвечает за создание таблиц и индексов в базе. Соответствующая функция на создание вызывается в начале работы сервиса. usage - отвечает за бизнес-логику, там выполняет конекшн к базе и все запросы с получением результата, который, в случае успеха на стороне postgres'а, возвращается в хэндлер.
4. В types-модуле хранятся структуры, отвечающие за принимаемые аргументы и возвращаемые значение. Это нужно для того, чтобы проверять корректность или отсутствие необходимых параметров.
5. В errors-модуле находится файл с функцией формирования JSON-ответа, если возникла ошибка на любом из уровней.

## Примеры запросов и ответов
**Запросы на создание нового объявления:**</br>
![create-1](https://user-images.githubusercontent.com/58785926/107116625-aac66580-6885-11eb-982b-f12623f78cda.png)
![create-2](https://user-images.githubusercontent.com/58785926/107116627-ac902900-6885-11eb-9c8a-e4e82cb612d7.png)
![create-3](https://user-images.githubusercontent.com/58785926/107116628-adc15600-6885-11eb-94ff-df061ed28637.png)
</br></br>
**Запросы на получение конкретного объявления:**</br>
![getone-1](https://user-images.githubusercontent.com/58785926/107116677-f4af4b80-6885-11eb-9dc9-9bd58ac05976.png)
![getone-2](https://user-images.githubusercontent.com/58785926/107116678-f5e07880-6885-11eb-8ebe-f0db35656557.png)
</br></br>
**Запросы на получение всех объявлений:**</br>
![getall-1](https://user-images.githubusercontent.com/58785926/107116709-27f1da80-6886-11eb-80de-4d9f96fba51d.png)
![getall-2](https://user-images.githubusercontent.com/58785926/107116710-288a7100-6886-11eb-93c3-6b5e862ebcb8.png)
![getall-3](https://user-images.githubusercontent.com/58785926/107116711-29230780-6886-11eb-8ee4-a3c3604519f0.png)
